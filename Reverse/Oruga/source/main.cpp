#include <cstdio>
#include <cstring>

using namespace std;
char maze[]={0x00,0x00,0x00,0x00,0x23,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x23,0x23,0x23,0x23,
             0x00,0x00,0x00,0x23,0x23,0x00,0x00,0x00,0x4f,0x4f,0x00,0x00,0x00,0x00,0x00,0x00,
             0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x4f,0x4f,0x00,0x50,0x50,0x00,0x00,0x00,
             0x00,0x00,0x00,0x4c,0x00,0x4f,0x4f,0x00,0x4f,0x4f,0x00,0x50,0x50,0x00,0x00,0x00,
             0x00,0x00,0x00,0x4c,0x00,0x4f,0x4f,0x00,0x4f,0x4f,0x00,0x50,0x00,0x00,0x00,0x00,
             0x00,0x00,0x4c,0x4c,0x00,0x4f,0x4f,0x00,0x00,0x00,0x00,0x50,0x00,0x00,0x00,0x00,
             0x00,0x00,0x00,0x00,0x00,0x4f,0x4f,0x00,0x00,0x00,0x00,0x50,0x00,0x00,0x00,0x00,
             0x23,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
             0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x23,0x00,0x00,0x00,
             0x00,0x00,0x00,0x00,0x00,0x00,0x4d,0x4d,0x4d,0x00,0x00,0x00,0x23,0x00,0x00,0x00,
             0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x4d,0x4d,0x4d,0x00,0x00,0x00,0x00,0x45,0x45,
             0x00,0x00,0x00,0x30,0x00,0x4d,0x00,0x4d,0x00,0x4d,0x00,0x00,0x00,0x00,0x45,0x00,
             0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x45,
             0x54,0x54,0x54,0x49,0x00,0x4d,0x00,0x4d,0x00,0x4d,0x00,0x00,0x00,0x00,0x45,0x00,
             0x00,0x54,0x00,0x49,0x00,0x4d,0x00,0x4d,0x00,0x4d,0x00,0x00,0x00,0x00,0x45,0x00,
             0x00,0x54,0x00,0x49,0x00,0x4d,0x00,0x4d,0x00,0x4d,0x21,0x00,0x00,0x00,0x45,0x45};
bool checkout(char* res){
    int dire=0,mark=5,loca=0;
    while(maze[dire]!=0x21){
        dire-=loca;
        if(res[mark]=='W'&&loca!=-16){
            loca=-16;
        }
        else if(res[mark]=='E'&&loca!=1){
            loca=1;
        }
        else if(res[mark]=='M'&&loca!=16){
            loca=16;
        }
        else if(res[mark]=='J'&&loca!=-1){
            loca=-1;
        }
        else{
            return false;
        }
        ++mark;
        while(!maze[dire]){
            if(loca==-1&&dire%16==0)
                return false;
            if(loca==1&&dire%16==15)
                return false;
            if(loca==16&&dire/16==15)
                return false;
            if(loca==-16&&dire/16==0)
                return false;
            dire+=loca;
        }
    }
    if(res[mark]=='}')
        return true;
    else return false;
}
int main() {
    char res[25];
    memset(res,0,sizeof(res));
    printf("Tell me the flag:");
    scanf("%s",res);
    char tmp1[6],chk[]={"actf{"};
    for(int i=0;i<5;++i){
        tmp1[i]=res[i];
    }
    tmp1[5]='\0';
    if(strcmp(tmp1,chk)){
        printf("Format false!");
        return 0;
    }
    if(checkout(res)){
        printf("That\'s True Flag!");
    }
    else{
        printf("don\'t stop trying...");
    }
    return 0;
}