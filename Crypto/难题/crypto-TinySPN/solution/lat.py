#!/usr/bin/python3
s_box = [6, 248, 9, 170, 212, 127, 73, 226, 91, 185, 184, 161, 45, 0, 224, 200, 20, 68, 99, 78, 39, 62, 11, 108, 220, 203, 42, 215, 107, 177, 86, 123, 202, 164, 16, 114, 81, 233, 160, 151, 30, 46, 100, 182, 238, 122, 106, 166, 223, 243, 28, 63, 102, 51, 77, 84, 216, 50, 21, 10, 205, 27, 89, 8, 80, 179, 142, 213, 101, 17, 231, 95, 93, 55, 251, 147, 197, 105, 66, 181, 88, 232, 236, 29, 36, 219, 90, 54, 33, 230, 146, 168, 124, 25, 97, 154, 152, 79, 82, 56, 149, 190, 222, 64, 192, 227, 126, 65, 225, 175, 13, 162, 186, 24, 241, 18, 76, 3, 131, 188, 120, 67, 103, 4, 229, 
180, 169, 134, 135, 144, 148, 83, 23, 143, 111, 201, 22, 253, 211, 242, 49, 70, 209, 61, 240, 
57, 150, 35, 174, 59, 157, 194, 26, 239, 125, 167, 193, 156, 141, 31, 128, 228, 52, 96, 247, 43, 85, 207, 7, 115, 140, 199, 171, 172, 109, 119, 244, 12, 121, 117, 74, 118, 191, 44, 40, 136, 153, 208, 112, 183, 217, 237, 19, 218, 165, 41, 204, 133, 72, 5, 138, 75, 250, 69, 196, 14, 
32, 210, 176, 155, 163, 137, 245, 249, 252, 47, 145, 48, 113, 34, 60, 158, 235, 2, 94, 234, 132, 187, 178, 139, 71, 98, 189, 1, 198, 129, 246, 255, 206, 221, 53, 110, 58, 87, 15, 214, 92, 
130, 254, 104, 159, 38, 173, 37, 116, 195]
count = []

def maskeq(a: int, b: int) -> bool:
    c: int = 0
    while b > 0:
        if b&1:
            c ^= (a&1)
        b //= 2
        a //= 2
    return c==0

def main():
    for row in range(256):
        print(row)
        count.append([])
        for col in range(256):
            cnt = 0
            bitmask = (row << 8) | col
            for i in range(256):
                if maskeq((i << 8) | s_box[i],  bitmask):
                    cnt += 1
            count[row].append(cnt)
    
    with open("LAT.csv", "w") as f:
        f.write("LAB OF SBOX,")
        for i in range(256):
            f.write("{},".format(i))
        f.write("\n")
        for i in range(256):
            f.write("{},".format(i))
            for j in range(256):
                f.write("{},".format(count[i][j]))
            f.write("\n")

if __name__ == "__main__":
    main()